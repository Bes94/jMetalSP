# jMetalSP: A framework for Big Data Optimization with multi-objective metaheuristics

**jMetalSP** is a software platform for dynamic multi-objective Big Data Optimization. It combines the features of the [jMetal](http://jmetal.github.io/jMetal/) multi-objective optimization framework with the [Apache Spark](http://spark.apache.org/) cluster computing system. jMetal provides the optimization infrastructure for implementing both the Big Data optimization problems and the dynamic metaheuristic to solve them; Spark allows to manage the streaming data sources, allowing to effectively use the computing power of Hadoop clusters when processing large amounts of data.

## Current status
We are currently working on a redesign of the framework with the following ideas in mind:
* Spark is incoupled in a separate module, so users only interested in non-Big Data dynamic optimization problems can use the core of jMetal without Spark.
* The architecture is being refactored:
 * The have introduced the observer pattern to link the stream data sources and algorithm outputs (the observables) with the problems and data consumers (the observers).
 * Unnecessary classes (i.e. problem and algorithm builders) have been removed.
 * Two different runtime systems can be used: plain Java and Java+Spark.
* We are refactoring the example published in the MOD 2016 paper becase the original Web service to obtain traffic data has changed. 
* Algorithms included: dynamic versions of NSGA-II, MOCell and SMPSO
* Problems included: bi-objective TSP, FDA problems.


## Architecture
The architecture of jMetalSP is depicted in the following UML class diagram:

![jMetalSP architecture](resources/jMetalSP1.1.png)

A `jMetalSPApplication` is composed of: 
* An instance of the`ProblemBuilder` class, which creates an instance of the `DynamicProblem` to be solved.
* An instance of the`ProblemBuilder` class to create the `DynamicAlgorithm`.
* One or more `StreamingDataSource` objects, which process the incoming data and as a result they change make some change in the `DynamicProblem`.
* One or more `AlgorithmDataConsumer` objects, which receive the results being generated by the `DynamicAlgorithm`.
* One `SparkRuntime` object to configure Apache Spark.

The implementation of jMetalSP applies Java generics to ensure that all the componentes are compatible. The declaration of the [`jMetalSPApplication`](https://github.com/jMetal/jMetalSP/blob/master/jmetalsp-core/src/main/java/org/uma/jmetalsp/JMetalSPApplication.java) class and its main componentes is the following:
```java
public class JMetalSPApplication<
    D extends UpdateData,
    P extends DynamicProblem<? extends Solution<?>, D>,
    A extends DynamicAlgorithm<?, D>,
		S extends StreamingDataSource<D,?>> {

  private List<S> streamingDataSourceList ;
  private List<AlgorithmDataConsumer> algorithmDataConsumerList ;
  private StreamingRuntime streamingRuntime ;

  private P problem ;
  private A algorithm ;
  public 
  ...
}
```
This way, by using generics the Java compiler can check that all the components fit together. 

As an example, the [jMetalSP application](https://github.com/jMetal/jMetalSP/blob/master/jmetalsp-application/src/main/java/org/uma/jmetalsp/application/biobjectivetsp/runner/newyorktraffic/DynamicTSPNSGAIIRunner.java) used in the paper to be presented in MOD 2016 (which solves a dynamic version of the bi-objective TSP problem with a dynamic variant of NSGA-II) is configured in this way:
```java
    JMetalSPApplication<
            MultiobjectiveTSPUpdateData,
            DynamicMultiobjectiveTSP,
            DynamicTSPNSGAII> application = new JMetalSPApplication<>();
    
    StreamingConfigurationTSP streamingConfigurationTSP= new StreamingConfigurationTSP();
    streamingConfigurationTSP.initializeDirectoryTSP(args[1]);
    
    application
            .setSparkRuntime(new SparkRuntime(1))
            .setProblemBuilder(new MultiobjectiveTSPBuilderParsed(fileName))
            .setAlgorithmBuilder(new DynamicNSGAIIBuilder())
            .addAlgorithmDataConsumer(new SimpleSolutionListConsumer())
            .addAlgorithmDataConsumer(new LocalDirectoryOutputConsumer(args[2]))
            .addStreamingDataSource(new StreamingDirectoryTSP(streamingConfigurationTSP))
            .run();
}
```

## References
* José A. Cordero, Antonio J. Nebro, Juan J. Durillo, José García-Nieto, Ismael Navas-Delgado, José F. Aldana-Montes: "Dynamic Multi-Objective Optimization With jMetal and Spark: a Case Study".[MOD 2016](http://dx.doi.org/10.1007/978-3-319-51469-7_9).
* Cristóbal Barba-González, José García-Nieto, Antonio J. Nebro and José F. Aldana-Montes. Multi-Objective Big Data Optimization with jMetal and Spark. To be presented in [EMO 2017](http://www.emo2017.org/).
* Cristóbal Barba-González, Antonio J. Nebro, José A. Cordero, José García-Nieto, Juan J. Durillo, Ismael Navas-Delgado, José F. Aldana-Montes. "JMetalSP: a Framework for Dynamic Multi-Objective Big Data Optimization". Submitted to Applied Soft Computing.

